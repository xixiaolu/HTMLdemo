<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>

</body>
<script>
    const url = "https://spark-api-open.xf-yun.com/v2/chat/completions";
    async function getResponse(content) {
        const resp = await fetch(url, {
            method: 'POST',
            headers: {
                "Content-Type": "application/json",
                "Authorization": "Bearer TAPxNRvSRcHDmLOoCmTT:CKqmLIVqiiolFcchGvHy",
                "Access-Control-Allow-Origin": "*",
            },
            body: JSON.stringify({
                "model": "x1",
                "user": "user_id",
                "messages": [
                    {
                        "role": "user",
                        "content": content,
                    }
                ],
            })
        })
        const reader = resp.body.getReader();
        while (1) {
            const textDecoder = new TextDecoder();
            const { done, value } = await reader.read();
            if (done) {
                break;
            }
            const txt = textDecoder.decode(value);
            console.log(txt);
        }
    }
</script>

</html>